<template>
  <lightning-card>
    <div class="title">Campaign</div>
    <div class="btn-container">
      <lightning-button
        label="Customize Email"
        onclick={openTemplateModal}
        variant="brand"
      ></lightning-button>
    </div>
    <div class="filters">
      <lightning-combobox
        name="campaign"
        label="Campaign"
        value={campaign}
        placeholder="Select a campaign"
        options={campaignOptions}
        onchange={handleComboboxChange}
      ></lightning-combobox>
    </div>
    <template if:true={rows.length}>
      <div class="datatable-container">
        <lightning-datatable
          key-field="id"
          data={rows}
          columns={columns}
          hide-checkbox-column
          onsort={handleSort}
          sorted-by={sortBy}
          sorted-direction={sortDirection}
        >
        </lightning-datatable>
      </div>
    </template>

    <template if:true={isModalOpen}>
      <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
          <header class="slds-modal__header">
            <h2 class="slds-text-heading_medium">Customize Email</h2>
          </header>
          <div class="slds-modal__content slds-p-around_medium">
            <lightning-combobox
              name="selectedTemplate"
              label="Template"
              value={selectedTemplate}
              placeholder="Select a template"
              options={templateOptions}
              onchange={handleComboboxChange}
            ></lightning-combobox>
            <lightning-input
              label="Subject"
              value={emailSubject}
              onchange={handleSubjectChange}
            ></lightning-input>
            <lightning-input-rich-text
              label="Body"
              value={emailBody}
              onchange={handleBodyChange}
            ></lightning-input-rich-text>

            <c-custom-template></c-custom-template>
          </div>
          <footer class="slds-modal__footer slds-grid slds-grid_align-end">
            <lightning-button
              label="Cancel"
              onclick={closeTemplateModal}
              variant="destructive"
            ></lightning-button>
            <lightning-button
              label="Send"
              onclick={handleEmailSend}
              variant="brand"
            ></lightning-button>
            <lightning-button
              label="Save"
              onclick={handleTemplateSave}
              variant="neutral"
            ></lightning-button>
          </footer>
        </div>
      </section>
      <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
  </lightning-card>
</template>
